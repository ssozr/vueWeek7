import{p as k,L as D,S as m}from"./PaginationView-96cedbb7.js";import{_ as P,M as g,r as b,o as d,c as n,d as t,F as h,f as u,a as y,t as l,h as C}from"./index-a467bfc2.js";const{VITE_APP_URL:_,VITE_APP_PATH:p}={VITE_APP_URL:"https://vue3-course-api.hexschool.io/",VITE_APP_PATH:"ssozr",BASE_URL:"/vueWeek7/",MODE:"production",DEV:!1,PROD:!0},L={data(){return{isLoading:!1,orders:[],delModal:"",delModalId:"",orderModal:"",orderModalId:"",orderData:"",pagination:{},page:""}},components:{pagination:k,Loading:D},methods:{getOrders(s=1){this.$http.get(`${_}/v2/api/${p}/admin/orders/?page=${s}`).then(o=>{this.isLoading=!1,this.orders=o.data.orders,this.pagination=o.data.pagination}).catch(o=>{console.log(o)})},opDelModal(s){this.delModalId=s,this.delModal.show()},deleteOrder(){const s=this.delModalId;this.$http.delete(`${_}/v2/api/${p}/admin/order/${s}`).then(o=>{m.fire(`${o.data.message}`),this.getOrders(),this.delModal.hide()}).catch(o=>{console.log(o)})},opOrderModal(s){this.orderModal.show(),this.orderData={...s}},upDataPaid(s){const o={is_paid:!s.is_paid};this.$http.put(`${_}/v2/api/${p}/admin/order/${s.id}`,{data:o}).then(i=>{m.fire(`${i.data.message}`),this.getOrders()}).catch(i=>{console.log(i)})},changePage(s){this.getOrders(s)},time(s){const o=new Date(s*1e3),i={year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric"};return o.toLocaleString("zh-TW",i)}},mounted(){this.isLoading=!0,this.getOrders(),this.delModal=new g(this.$refs.delModal),this.orderModal=new g(this.$refs.orderModal)}},O={class:"table"},E=t("thead",null,[t("tr",null,[t("th",null,"購買時間"),t("th",null,"Email"),t("th",null,"購買款項"),t("th",null,"應付金額"),t("th",null,"是否付款"),t("th",null,"編輯")])],-1),I={class:"list-unstyled"},w={class:"form-check form-switch"},V=["checked","onClick"],x=["for"],A={key:0},T={key:1},$=["onClick"],S=["onClick"],U={class:"modal",tabindex:"-1",id:"delModal",ref:"delModal"},B={class:"modal-dialog"},R={class:"modal-content"},N=t("div",{class:"modal-header"},[t("h5",{class:"modal-title"},"確認刪除?"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),q={class:"modal-body"},z={class:"modal-footer"},F=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"取消",-1),H={class:"modal",tabindex:"-1",id:"orderModal",ref:"orderModal"},W={class:"modal-dialog"},j={class:"modal-content"},G={class:"modal-header"},J={class:"modal-title"},K=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),Q={class:"modal-body"},X={key:0};function Y(s,o,i,Z,a,r){const v=b("pagination"),M=b("loading");return d(),n(h,null,[t("table",O,[E,t("tbody",null,[(d(!0),n(h,null,u(a.orders,e=>(d(),n("tr",{key:e.id},[t("td",null,l(r.time(e.create_at)),1),t("td",null,l(e.user.email),1),t("td",null,[t("ul",I,[(d(!0),n(h,null,u(e.products,(c,f)=>(d(),n("li",{key:f},l(c.product.title)+"*"+l(c.qty)+"="+l(c.total),1))),128))])]),t("td",null,l(e.total),1),t("td",null,[t("div",w,[t("input",{class:"form-check-input",type:"checkbox",role:"switch",id:"item.id",checked:e.is_paid,onClick:c=>r.upDataPaid(e)},null,8,V),t("label",{class:"form-check-label",for:e.id},[e.is_paid?(d(),n("p",A,"已付款")):(d(),n("p",T,"未付款"))],8,x)])]),t("td",null,[t("button",{type:"button",class:"btn btn-outline-primary",onClick:c=>r.opOrderModal(e)},"檢視",8,$),t("button",{type:"button",class:"btn btn-outline-primary",onClick:c=>r.opDelModal(e.id)},"刪除",8,S)])]))),128))])]),y(v,{pages:a.pagination,onChangePage:r.changePage},null,8,["pages","onChangePage"]),y(M,{active:a.isLoading,"onUpdate:active":o[0]||(o[0]=e=>a.isLoading=e)},null,8,["active"]),t("div",U,[t("div",B,[t("div",R,[N,t("div",q,[t("p",null,"訂單編號:"+l(a.delModalId),1)]),t("div",z,[F,t("button",{type:"button",onClick:o[1]||(o[1]=e=>r.deleteOrder()),class:"btn btn-primary"},"確定刪除")])])])],512),t("div",H,[t("div",W,[t("div",j,[t("div",G,[t("h5",J,"訂單編號"+l(a.orderData.id),1),K]),t("div",Q,[t("ul",null,[(d(!0),n(h,null,u(a.orderData.products,e=>(d(),n("li",{key:e.id},l(e.product.title)+" 數量:"+l(e.qty),1))),128))]),a.orderData?(d(),n("ul",X,[t("li",null,"訂單人姓名"+l(a.orderData.user.name),1),t("li",null,"信箱"+l(a.orderData.user.email),1),t("li",null,"電話"+l(a.orderData.user.tel),1),t("li",null,"備註"+l(a.orderData.user.address),1)])):C("",!0)])])])],512)],64)}const ot=P(L,[["render",Y]]);export{ot as default};
